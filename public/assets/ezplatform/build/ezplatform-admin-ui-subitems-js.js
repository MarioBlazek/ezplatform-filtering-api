(window.webpackJsonp=window.webpackJsonp||[]).push([["ezplatform-admin-ui-subitems-js"],{34:function(e,t,n){e.exports=n("K4Cz")},AJkD:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.a=function e(t){var n;if("object"!==r(t))return t;if(!t)return t;if("[object Array]"===Object.prototype.toString.apply(t)){n=[];for(var i=0;i<t.length;i++)n[i]=e(t[i]);return n}for(var a in n={},t)t.hasOwnProperty(a)&&(n[a]=e(t[a]));return n}},K4Cz:function(e,t,n){"use strict";n.r(t),n.d(t,"ASCENDING_SORT_ORDER",(function(){return _t})),n.d(t,"default",(function(){return wt}));var r=n("cDcd"),i=n.n(r),a=n("faye"),o=n.n(a),s=n("rf6O"),l=n.n(s),c=n("uHg5"),u=function(e){var t=e.id,n=e.icon,r=e.title,a=e.onClick,o=e.activeView,s=e.isDisabled,l={id:t,onClick:function(){return a(t)},className:"c-view-switcher-btn",title:r,tabIndex:"-1"},u={name:n,extraClasses:"ez-icon--secondary ez-icon--small"};return o===t&&(l.className="".concat("c-view-switcher-btn"," ").concat("c-view-switcher-btn","--active"),u.extraClasses="ez-icon--light ez-icon--small"),s&&(l.className="".concat(l.className," ").concat("c-view-switcher-btn","--disabled")),i.a.createElement("div",l,i.a.createElement(c.a,u))};u.propTypes={id:l.a.string.isRequired,activeView:l.a.string.isRequired,isDisabled:l.a.bool.isRequired,icon:l.a.string.isRequired,title:l.a.string.isRequired,onClick:l.a.func.isRequired};var d=u,f=function(e){var t=e.onViewChange,n=e.activeView,r=e.isDisabled,a="c-view-switcher";r&&(a="".concat(a," ").concat(a,"--disabled"));var o=Translator.trans("switch_to_list_view.btn.label",{},"sub_items"),s=Translator.trans("switch_to_grid_view.btn.label",{},"sub_items");return i.a.createElement("div",{className:a},i.a.createElement(d,{id:"table",icon:"view-list",title:o,onClick:t,activeView:n,isDisabled:r}),i.a.createElement(d,{id:"grid",icon:"view-grid",title:s,onClick:t,activeView:n,isDisabled:r}))};f.propTypes={onViewChange:l.a.func.isRequired,activeView:l.a.string.isRequired,isDisabled:l.a.bool.isRequired};var m=f;function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O(e);if(t){var i=O(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return C(this,n)}}function C(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?S(e):t}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=window.eZ.helpers.timezone.formatShortDateTime,I=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(s,e);var t,n,a,o=w(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).storePriorityValue=t.storePriorityValue.bind(S(t)),t.enablePriorityInput=t.enablePriorityInput.bind(S(t)),t.handleSubmit=t.handleSubmit.bind(S(t)),t.handleCancel=t.handleCancel.bind(S(t)),t.handleEdit=t.handleEdit.bind(S(t)),t.onSelectCheckboxChange=t.onSelectCheckboxChange.bind(S(t)),t.setPriorityInputRef=t.setPriorityInputRef.bind(S(t)),t.getLanguageSelectorData=t.getLanguageSelectorData.bind(S(t)),t.editItem=t.editItem.bind(S(t)),t._refPriorityInput=null,t.state={priorityValue:e.item.priority,priorityInputEnabled:!1,startingPriorityValue:e.item.priority},t.columnsRenderers={name:t.renderNameCell.bind(S(t)),modified:t.renderModifiedCell.bind(S(t)),"content-type":t.renderContentTypeCell.bind(S(t)),priority:t.renderPriorityCell.bind(S(t)),translations:t.renderTranslationsCell.bind(S(t)),visibility:t.renderVisibilityCell.bind(S(t)),creator:t.renderCreatorCell.bind(S(t)),contributor:t.renderContributorCell.bind(S(t)),published:t.renderPublishedCell.bind(S(t)),section:t.renderSectionCell.bind(S(t)),"location-id":t.renderLocationIdCell.bind(S(t)),"location-remote-id":t.renderLocationRemoteIdCell.bind(S(t)),"object-id":t.renderObjectIdCell.bind(S(t)),"object-remote-id":t.renderObjectRemoteIdCell.bind(S(t))},t}return t=s,(n=[{key:"enablePriorityInput",value:function(){this.setState((function(){return{priorityInputEnabled:!0}}))}},{key:"handleCancel",value:function(e){e.preventDefault(),this.setState((function(e){return{priorityInputEnabled:!1,priorityValue:e.startingPriorityValue}}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.onItemPriorityUpdate({pathString:this.props.item.pathString,priority:this._refPriorityInput.value}),this.setState((function(){return{priorityValue:t._refPriorityInput.value,priorityInputEnabled:!1,startingPriorityValue:t._refPriorityInput.value}}))}},{key:"storePriorityValue",value:function(e){var t=this;e.preventDefault(),this.setState((function(){return{priorityValue:t._refPriorityInput.value}}))}},{key:"editItem",value:function(e){var t=this.props.item.content._info,n=t.id,r=t.currentVersion;this.props.handleEditItem({_id:n,mainLanguageCode:e,CurrentVersion:{Version:{VersionInfo:{versionNo:r.versionNumber}}}},this.props.item.id)}},{key:"handleEdit",value:function(){var e=this.props.item.content._info,t=e.mainLanguageCode;e.currentVersion.languageCodes.length>1?(this.props.setLanguageSelectorData(this.getLanguageSelectorData()),this.props.openLanguageSelector()):this.editItem(t)}},{key:"setPriorityInputRef",value:function(e){this._refPriorityInput=e}},{key:"renderNameCell",value:function(){var e=this.props,t=e.item,n=e.generateLink,r=t.content._name,a={className:"c-table-view-item__link c-table-view-item__text-wrapper",href:n(t.id,t.content._info.id)};return i.a.createElement("a",a,r)}},{key:"renderPriorityCell",value:function(){var e={type:"number",defaultValue:this.state.priorityValue,onChange:this.storePriorityValue},t={},n={};return this.state.priorityInputEnabled||(e.readOnly=!0,delete e.defaultValue,e.value=this.state.priorityValue,t.onClick=this.enablePriorityInput,n.hidden=!0),i.a.createElement("div",v({className:"c-table-view-item__priority-wrapper"},t),i.a.createElement("div",{className:"c-table-view-item__inner-wrapper c-table-view-item__inner-wrapper--input"},i.a.createElement("input",v({className:"c-table-view-item__priority-value",ref:this.setPriorityInputRef},e))),i.a.createElement("div",v({className:"c-table-view-item__priority-actions"},n),i.a.createElement("button",{type:"button",className:"c-table-view-item__btn c-table-view-item__btn--cancel",onClick:this.handleCancel},i.a.createElement(c.a,{name:"discard",extraClasses:"ez-icon--medium ez-icon--light"})),i.a.createElement("button",{type:"button",className:"c-table-view-item__btn c-table-view-item__btn--submit",onClick:this.handleSubmit},i.a.createElement(c.a,{name:"checkmark",extraClasses:"ez-icon--medium ez-icon--light"}))))}},{key:"renderModifiedCell",value:function(){var e=this.props.item.content._info.modificationDate;return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},P(new Date(1e3*e.timestamp)))}},{key:"renderPublishedCell",value:function(){var e=this.props.item.content._info.publishedDate;return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},P(new Date(1e3*e.timestamp)))}},{key:"renderContentTypeCell",value:function(){var e=this.props.item.content._info.contentType.name;return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},e)}},{key:"renderTranslationsCell",value:function(){var e=this.props,t=e.item,n=e.languages;return i.a.createElement(r.Fragment,null,t.content._info.currentVersion.languageCodes.map((function(e){return i.a.createElement("span",{key:e,className:"c-table-view-item__translation"},n.mappings[e].name)})))}},{key:"renderVisibilityCell",value:function(){var e=this.props.item,t=e.invisible,n=e.hidden,r=Translator.trans("items_table.row.visible.label",{},"sub_items"),a=Translator.trans("items_table.row.not_visible.label",{},"sub_items"),o=t||n?a:r;return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},o)}},{key:"renderCreatorCell",value:function(){return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},this.getName(this.props.item.content._info.owner))}},{key:"renderContributorCell",value:function(){return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},this.getName(this.props.item.content._info.currentVersion.creator))}},{key:"renderSectionCell",value:function(){return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},this.getName(this.props.item.content._info.section))}},{key:"renderLocationIdCell",value:function(){return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},this.props.item.id)}},{key:"renderLocationRemoteIdCell",value:function(){return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},this.props.item.remoteId)}},{key:"renderObjectIdCell",value:function(){return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},this.props.item.content._info.id)}},{key:"renderObjectRemoteIdCell",value:function(){return i.a.createElement("div",{className:"c-table-view-item__text-wrapper"},this.props.item.content._info.remoteId)}},{key:"renderBasicColumns",value:function(){var e=this,t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({name:!0},this.props.columnsVisibility);return Object.entries(t).map((function(t){var n=b(t,2),r=n[0];return n[1]?i.a.createElement("td",{key:r,className:"c-table-view-item__cell c-table-view-item__cell--".concat(r)},e.columnsRenderers[r]()):null}))}},{key:"getName",value:function(e){return e?e.name:""}},{key:"onSelectCheckboxChange",value:function(e){var t=this.props,n=t.item;(0,t.onItemSelect)(n,e.target.checked)}},{key:"getLanguageSelectorData",value:function(){var e=this.props.languages.mappings,t=this.props.item.content._info.currentVersion.languageCodes,n=Translator.trans("languages.modal.label",{},"sub_items"),r=t.map((function(t){return{label:e[t].name,value:t}}));return{languageItems:r,label:"".concat(n," (").concat(r.length,")"),handleItemChange:this.editItem}}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.isSelected,r=Translator.trans("edit_item_btn.label",{},"sub_items"),a=t.content._info.contentType.identifier,o=eZ.helpers.contentType.getContentTypeIconUrl(a);return i.a.createElement("tr",{className:"c-table-view-item"},i.a.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--checkbox"},i.a.createElement("input",{type:"checkbox",checked:n,onChange:this.onSelectCheckboxChange})),i.a.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--icon"},i.a.createElement(c.a,{customPath:o,extraClasses:"ez-icon--small"})),this.renderBasicColumns(),i.a.createElement("td",{className:"c-table-view-item__cell c-table-view-item__cell--actions"},i.a.createElement("span",{title:r,"data-extra-classes":"c-table-view-item__tooltip",onClick:this.handleEdit,className:"c-table-view-item__btn c-table-view-item__btn--edit",tabIndex:-1},i.a.createElement("div",{className:"c-table-view-item__btn-inner"},i.a.createElement(c.a,{name:"edit",extraClasses:"ez-icon--medium"})))))}}])&&_(t.prototype,n),a&&_(t,a),s}(r.PureComponent);I.propTypes={item:l.a.object.isRequired,isSelected:l.a.bool.isRequired,onItemPriorityUpdate:l.a.func.isRequired,handleEditItem:l.a.func.isRequired,generateLink:l.a.func.isRequired,languages:l.a.object.isRequired,onItemSelect:l.a.func.isRequired,columnsVisibility:l.a.object.isRequired};var E=function(e){var t=e.label,n=e.isColumnVisible,r=e.toggleColumnVisibility,a=e.columnKey;return i.a.createElement("li",{className:"c-table-view-columns-toggler-list-element",onClick:function(){return r(a)}},i.a.createElement("div",{className:"form-check form-check-inline"},i.a.createElement("input",{className:"form-check-input",type:"checkbox",checked:n,readOnly:!0}),i.a.createElement("label",{className:"c-table-view-columns-toggler-list-element__label form-check-label"},t)))};E.propTypes={label:l.a.string.isRequired,columnKey:l.a.string.isRequired,isColumnVisible:l.a.bool.isRequired,toggleColumnVisibility:l.a.func.isRequired};var j=E;function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=x(e);if(t){var i=x(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return A(this,n)}}function A(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?V(e):t}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(s,e);var t,n,a,o=D(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=o.call(this,e)).togglePanel=t.togglePanel.bind(V(t)),t.hidePanel=t.hidePanel.bind(V(t)),t._refTogglerButton=Object(r.createRef)(),t._refPanel=Object(r.createRef)(),t.state={isOpen:!1,buttonBottomDocumentOffset:null,panelHeight:null},t}return t=s,(n=[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("click",this.hidePanel,!1),this.setState((function(){return{buttonBottomDocumentOffset:e.getBtnBottomDocumentOffset()}}))}},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.isOpen,n=e.panelHeight;t&&null===n&&this.setState({panelHeight:this._refPanel.current.offsetHeight})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hidePanel)}},{key:"getBtnBottomDocumentOffset",value:function(){var e=this._refTogglerButton.current.getBoundingClientRect().top+window.scrollY;return document.documentElement.scrollHeight-e}},{key:"hidePanel",value:function(e){var t=e.target;this.state.isOpen&&(t.closest(".c-table-view-columns-toggler")||this.setState((function(){return{isOpen:!1}})))}},{key:"togglePanel",value:function(){this.setState((function(e){return{isOpen:!e.isOpen}}))}},{key:"renderPanel",value:function(){if(!this.state.isOpen)return null;var e=this.props,t=e.columnsVisibility,n=e.toggleColumnVisibility,r=this.state,a=r.buttonBottomDocumentOffset,o=r.panelHeight,s=o||450,l={className:"c-table-view-columns-toggler__panel",ref:this._refPanel};return a<s&&(l.className="".concat(l.className," ").concat(l.className,"--above-btn")),i.a.createElement("div",l,i.a.createElement("ul",{className:"c-table-view-columns-toggler__list"},Object.entries(t).map((function(e){var t=N(e,2),r=t[0],a=t[1],o=be[r];return i.a.createElement(j,{key:r,label:o,columnKey:r,isColumnVisible:a,toggleColumnVisibility:n})}))))}},{key:"render",value:function(){var e=Translator.trans("items_table.header.filters",{},"sub_items");return i.a.createElement("div",{className:"c-table-view-columns-toggler"},i.a.createElement("button",{ref:this._refTogglerButton,type:"button",title:e,className:"btn btn-dark c-table-view-columns-toggler__btn",onClick:this.togglePanel},i.a.createElement(c.a,{name:"filters",extraClasses:"ez-icon--small ez-icon--light"})),this.renderPanel())}}])&&L(t.prototype,n),a&&L(t,a),s}(r.Component);function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function H(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}U.propTypes={columnsVisibility:l.a.object.isRequired,toggleColumnVisibility:l.a.func.isRequired};var z=function(e){var t=e.indeterminate,n=H(e,["indeterminate"]);return i.a.createElement("input",q({},n,{type:"checkbox",ref:function(e){e&&(e.indeterminate=t)}}))};z.propTypes={indeterminate:l.a.bool};var M=z,F=n("nLu2");function Z(e){return function(e){if(Array.isArray(e))return K(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||W(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||W(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var X=function(e){var t=Object(r.useRef)(null),n=J(Object(r.useState)(""),2),a=n[0],o=n[1],s=J(Object(r.useState)([]),2),l=s[0],c=s[1],u=null;return Object(r.useEffect)((function(){var e=Z(t.current.querySelectorAll(".ez-instant-filter__item")).map((function(e){return{label:e.textContent.toLowerCase(),element:e}}));c(e)}),[e.items]),Object(r.useEffect)((function(){var e=a.toLowerCase();return u=window.setTimeout((function(){l.forEach((function(t){var n=t.label.includes(e)?"removeAttribute":"setAttribute";t.element[n]("hidden",!0)}))}),200),function(){window.clearTimeout(u)}}),[a]),i.a.createElement("div",{className:"ez-instant-filter",ref:t},i.a.createElement("div",{className:"ez-instant-filter__input-wrapper"},i.a.createElement("input",{type:"text",className:"ez-instant-filter__input form-control",placeholder:Translator.trans("instant.filter.placeholder",{},"sub_items"),value:a,onChange:function(e){return o(e.target.value)}})),i.a.createElement("div",{className:"ez-instant-filter__items"},e.items.map((function(t){var n="item_".concat(t.value);return i.a.createElement("div",{className:"ez-instant-filter__item"},i.a.createElement("div",{className:"form-check"},i.a.createElement("input",{type:"radio",id:n,name:"items",className:"form-check-input",value:t.value,onChange:function(){return e.handleItemChange(t.value)}}),i.a.createElement("label",{className:"form-check-label",for:n},t.label)))}))))};X.propTypes={items:l.a.array,handleItemChange:l.a.func},X.defaultProps={items:[],handleItemChange:function(){}};var $=X,G=function(e){var t=Object(F.a)({"ez-extra-actions":!0,"c-language-selector":!0,"ez-extra-actions--edit":!0,"ez-extra-actions--hidden":!e.isOpen}),n=function(t){t.target.closest(".c-table-view-item__btn")||t.target.classList.contains("ez-instant-filter__input")||e.close()};return Object(r.useEffect)((function(){return window.document.addEventListener("click",n,!1),function(){window.document.removeEventListener("click",n)}}),[]),i.a.createElement("div",{className:t},i.a.createElement("div",{className:"ez-extra-actions__header"},e.label),i.a.createElement("div",{className:"ez-extra-actions__content"},i.a.createElement($,{items:e.languageItems,handleItemChange:e.handleItemChange})))};G.propTypes={isOpen:l.a.bool,label:l.a.string,languageItems:l.a.array,handleItemChange:l.a.func,closeLanguageSelector:l.a.func},G.defaultProps={isOpen:!1,label:"",languageItems:[],handleItemChange:function(){},closeLanguageSelector:function(){}};var Q=G;function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=de(e);if(t){var i=de(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return ce(this,n)}}function ce(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?ue(e):t}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fe={modified:!0,"content-type":!0,priority:!0,translations:!0,visibility:!0,creator:!0,contributor:!0,published:!0,section:!0,"location-id":!0,"location-remote-id":!0,"object-id":!0,"object-remote-id":!0},me={name:"ContentName",modified:"DateModified",priority:"LocationPriority"},pe="".concat("c-table-view__cell"," ").concat("c-table-view__cell","--head"),be={name:Translator.trans("items_table.header.name",{},"sub_items"),modified:Translator.trans("items_table.header.modified",{},"sub_items"),"content-type":Translator.trans("items_table.header.content_type",{},"sub_items"),priority:Translator.trans("items_table.header.priority",{},"sub_items"),translations:Translator.trans("items_table.header.translations",{},"sub_items"),visibility:Translator.trans("items_table.header.visibility",{},"sub_items"),creator:Translator.trans("items_table.header.creator",{},"sub_items"),contributor:Translator.trans("items_table.header.contributor",{},"sub_items"),published:Translator.trans("items_table.header.pubished",{},"sub_items"),section:Translator.trans("items_table.header.section",{},"sub_items"),"location-id":Translator.trans("items_table.header.location_id",{},"sub_items"),"location-remote-id":Translator.trans("items_table.header.location_remote_id",{},"sub_items"),"object-id":Translator.trans("items_table.header.object_id",{},"sub_items"),"object-remote-id":Translator.trans("items_table.header.object_remote_id",{},"sub_items")},he=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(l,e);var t,n,o,s=le(l);function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).renderItem=t.renderItem.bind(ue(t)),t.selectAll=t.selectAll.bind(ue(t)),t.setColumnsVisibilityInLocalStorage=t.setColumnsVisibilityInLocalStorage.bind(ue(t)),t.toggleColumnVisibility=t.toggleColumnVisibility.bind(ue(t)),t.setLanguageSelectorData=t.setLanguageSelectorData.bind(ue(t)),t.openLanguageSelector=t.openLanguageSelector.bind(ue(t)),t.closeLanguageSelector=t.closeLanguageSelector.bind(ue(t)),t._refColumnsTogglerButton=Object(r.createRef)(),t.state={columnsVisibility:t.getColumnsVisibilityFromLocalStorage(),languageSelectorData:{},languageSelectorOpen:!1},t}return t=l,(n=[{key:"getColumnsVisibilityFromLocalStorage",value:function(){var e=localStorage.getItem("sub-items_columns-visibility"),t=ie({},fe);return e&&Object.entries(JSON.parse(e)).forEach((function(e){var n=te(e,2),r=n[0],i=n[1];r in t&&(t[r]=i)})),t}},{key:"setColumnsVisibilityInLocalStorage",value:function(){var e=JSON.stringify(this.state.columnsVisibility);localStorage.setItem("sub-items_columns-visibility",e)}},{key:"selectAll",value:function(){var e=this.props;(0,e.toggleAllItemsSelect)(!e.selectedLocationsIds.size)}},{key:"toggleColumnVisibility",value:function(e){this.setState((function(t){return{columnsVisibility:ie(ie({},t.columnsVisibility),{},ae({},e,!t.columnsVisibility[e]))}}),this.setColumnsVisibilityInLocalStorage)}},{key:"setLanguageSelectorData",value:function(e){this.setState({languageSelectorData:e})}},{key:"openLanguageSelector",value:function(){this.setState({languageSelectorOpen:!0})}},{key:"closeLanguageSelector",value:function(){this.setState({languageSelectorOpen:!1})}},{key:"renderItem",value:function(e){var t=this.state.columnsVisibility,n=this.props,r=n.handleItemPriorityUpdate,a=n.handleEditItem,o=n.generateLink,s=n.languages,l=n.onItemSelect,c=n.selectedLocationsIds.has(e.id);return i.a.createElement(I,{key:e.id,item:e,onItemPriorityUpdate:r,languages:s,handleEditItem:a,generateLink:o,onItemSelect:l,isSelected:c,columnsVisibility:t,setLanguageSelectorData:this.setLanguageSelectorData,openLanguageSelector:this.openLanguageSelector})}},{key:"renderBasicColumnsHeader",value:function(){var e=this.props,t=e.sortClause,n=e.sortOrder,r=e.onSortChange,a=ie({name:!0},this.state.columnsVisibility);return Object.entries(a).map((function(e){var a=te(e,2),o=a[0];if(!a[1])return null;var s=pe,l=null;return o in me&&(s+=" ".concat("c-table-view__cell","--sortable"),me[o]===t&&(s+=" ".concat("c-table-view__cell","ascending"===n?"--sorted-asc":"--sorted-desc")),l=function(){r(me[o])}),i.a.createElement("th",{key:o,className:s,onClick:l,tabIndex:-1},i.a.createElement("span",{className:"c-table-view__label"},be[o]))}))}},{key:"renderHead",value:function(){if(!this.props.items.length)return null;var e=this.state.columnsVisibility,t=this.props,n=t.selectedLocationsIds,r=t.items,a=!!n.size,o=n.size===r.length,s=a&&!o;return i.a.createElement("thead",{className:"c-table-view__head"},i.a.createElement("tr",{className:"c-table-view__row"},i.a.createElement("th",{className:"".concat(pe," ").concat("c-table-view__cell","--checkbox")},i.a.createElement(M,{indeterminate:s,checked:a,onClick:this.selectAll,onChange:function(){}})),i.a.createElement("th",{className:pe}),this.renderBasicColumnsHeader(),i.a.createElement("th",{className:"".concat(pe," ").concat("c-table-view__cell","--actions")},i.a.createElement(U,{columnsVisibility:e,toggleColumnVisibility:this.toggleColumnVisibility}))))}},{key:"render",value:function(){var e=this.props.items.map(this.renderItem);return i.a.createElement("div",{className:"c-table-view__wrapper"},i.a.createElement("div",{className:"c-table-view__scroller"},i.a.createElement("table",{className:"c-table-view"},this.renderHead(),i.a.createElement("tbody",{className:"c-table-view__body"},e))),Object(a.createPortal)(i.a.createElement(Q,ee({isOpen:this.state.languageSelectorOpen,close:this.closeLanguageSelector},this.state.languageSelectorData)),window.document.querySelector(".ez-extra-actions-container")))}}])&&oe(t.prototype,n),o&&oe(t,o),l}(r.Component);he.propTypes={items:l.a.arrayOf(l.a.object).isRequired,handleItemPriorityUpdate:l.a.func.isRequired,generateLink:l.a.func.isRequired,handleEditItem:l.a.func.isRequired,languages:l.a.object.isRequired,onItemSelect:l.a.func.isRequired,toggleAllItemsSelect:l.a.func.isRequired,selectedLocationsIds:l.a.instanceOf(Set),onSortChange:l.a.func.isRequired,sortClause:l.a.string.isRequired,sortOrder:l.a.string.isRequired};var ye=function(e){var t=e.item,n=e.generateLink,r=t.id,a=t.content,o=a._info.contentType.identifier,s=eZ.helpers.contentType.getContentTypeIconUrl(o),l=null,u=null;if(a._thumbnail){var d=a._thumbnail,f=d.uri,m=d.alternativeText;l=i.a.createElement("img",{className:"c-grid-view-item__image",src:f,alt:m}),u=i.a.createElement("div",{className:"c-grid-view-item__content-type"},i.a.createElement(c.a,{customPath:s,extraClasses:"ez-icon--small"}))}else l=i.a.createElement("div",{className:"".concat("c-grid-view-item__image"," ").concat("c-grid-view-item__image","--none")},i.a.createElement(c.a,{customPath:s,extraClasses:"ez-icon--extra-large"}));return i.a.createElement("a",{className:"c-grid-view-item",href:n(r,a._info.id)},u,i.a.createElement("div",{className:"c-grid-view-item__image-wrapper"},l),i.a.createElement("div",{className:"c-grid-view-item__title"},a._name))};ye.propTypes={item:l.a.object.isRequired,generateLink:l.a.func.isRequired};var ge=ye,ve=function(e){var t=e.items,n=e.generateLink;return i.a.createElement("div",{className:"c-grid-view"},t.map((function(e){return i.a.createElement(ge,{key:e.id,item:e,generateLink:n})})))};ve.propTypes={items:l.a.arrayOf(l.a.object),generateLink:l.a.func.isRequired};var _e={table:he,grid:ve},ke=function(e){var t=_e[e.activeView];return i.a.createElement(t,e)};ke.propTypes={activeView:l.a.string.isRequired,items:l.a.arrayOf(l.a.object),handleItemPriorityUpdate:l.a.func.isRequired,handleEditItem:l.a.func.isRequired,generateLink:l.a.func.isRequired,languages:l.a.object.isRequired,onItemSelect:l.a.func.isRequired,toggleAllItemsSelect:l.a.func.isRequired,selectedLocationsIds:l.a.instanceOf(Set).isRequired,onSortChange:l.a.func.isRequired,sortClause:l.a.string.isRequired,sortOrder:l.a.string.isRequired};var we=ke,Ce=n("xeH2"),Se=n.n(Ce);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){Ee(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Re(e);if(t){var i=Re(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return Be(this,n)}}function Be(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?Le(e):t}function Le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e){return(Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var De={backdrop:"static",keyboard:!0},Ae={small:"modal-sm",medium:"",large:"modal-lg"},Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(o,e);var t,n,r,a=Ne(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this,e))._refModal=null,t.setModalRef=t.setModalRef.bind(Le(t)),t.onKeyUp=t.onKeyUp.bind(Le(t)),t.state={isVisible:e.isVisible,isLoading:e.isLoading},t}return t=o,(n=[{key:"componentDidMount",value:function(){var e=this.state.isVisible;e&&(Se()(this._refModal).modal(Ie(Ie({},De),{},{show:e,focus:this.props.hasFocus})),this.attachModalEventHandlers())}},{key:"componentDidUpdate",value:function(){var e=this.state.isVisible;Se()(this._refModal).modal(Ie(Ie({},De),{},{show:e,focus:this.props.hasFocus})),e&&this.attachModalEventHandlers()}},{key:"componentWillUnmount",value:function(){Se()(this._refModal).modal("hide"),document.body.classList.remove("modal-open","ezs-non-scrollable")}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.isVisible,n=e.onConfigIframeLoad,r=e.isLoading;this.setState((function(e){return Ie(Ie({},e),{},{isVisible:t,onConfigIframeLoad:n,isLoading:r})}))}},{key:"attachModalEventHandlers",value:function(){var e=Se()(this._refModal);e.on("keyup",this.onKeyUp),e.one("hidden.bs.modal",this.props.onClose)}},{key:"onKeyUp",value:function(e){var t=e.originalEvent;t&&(27===t.which||27===t.keyCode)&&this.props.onClose()}},{key:"setModalRef",value:function(e){this._refModal=e}},{key:"renderHeader",value:function(){var e=Translator.trans("popup.close.label",{},"universal_discovery_widget");return i.a.createElement("div",{className:"modal-header c-popup__header"},this.renderHeadline(),i.a.createElement("button",{type:"button",className:"close c-popup__btn--close","data-dismiss":"modal","aria-label":e,onClick:this.props.onClose},i.a.createElement(c.a,{name:"discard",extraClasses:"ez-icon--medium"})))}},{key:"renderHeadline",value:function(){return this.props.title?i.a.createElement("h3",{className:"modal-title c-popup__headline",title:this.props.title},i.a.createElement("span",{className:"c-popup__title"},this.props.title),this.renderSubtitle()):null}},{key:"renderSubtitle",value:function(){var e=this.props.subtitle;return e?i.a.createElement("span",{className:"c-popup__subtitle"},e):null}},{key:"renderFooter",value:function(){var e=this.props.footerChildren;if(e)return i.a.createElement("div",{className:"modal-footer c-popup__footer"},e)}},{key:"render",value:function(){var e=this.state.isVisible,t=this.props,n=t.additionalClasses,r=t.size,a=t.noHeader,o={className:"c-popup modal fade",ref:this.setModalRef,tabIndex:this.props.hasFocus?-1:void 0};return document.body.classList.toggle("modal-open",e),document.body.classList.toggle("ezs-non-scrollable",e),n&&(o.className="".concat(o.className," ").concat(n)),a&&(o.className="".concat(o.className," c-popup--no-header")),i.a.createElement("div",o,i.a.createElement("div",{className:"modal-dialog c-popup__dialog ".concat(Ae[r]),role:"dialog"},i.a.createElement("div",{className:"modal-content c-popup__content"},this.renderHeader(),i.a.createElement("div",{className:"modal-body c-popup__body"},this.props.children),this.renderFooter())))}}])&&je(t.prototype,n),r&&je(t,r),o}(r.Component);Ve.propTypes={isVisible:l.a.bool,isLoading:l.a.bool,onClose:l.a.func.isRequired,onConfigIframeLoad:l.a.func,children:l.a.element.isRequired,title:l.a.string,subtitle:l.a.string,hasFocus:l.a.bool,additionalClasses:l.a.string,footerChildren:l.a.element,size:l.a.string,noHeader:l.a.bool},Ve.defaultProps={isVisible:!1,isLoading:!0,hasFocus:!0,size:"large",noHeader:!1,onConfigIframeLoad:function(){}};var xe=Ve;function Ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qe=function(e){var t,n=e.disabled,r=e.onClick,a=e.label,o=e.type,s={type:"button",title:a,tabIndex:"-1",onClick:function(){n||r()}};return s.disabled=!!n&&"disabled",s.className=Object(F.a)((Ue(t={},"c-action-btn",!0),Ue(t,"".concat("c-action-btn","--disabled"),n),Ue(t,"".concat("c-action-btn","--").concat(o),!!o),t)),i.a.createElement("button",s,i.a.createElement(c.a,{name:o,extraClasses:"ez-icon--light ez-icon--medium"}))};qe.propTypes={label:l.a.string.isRequired,disabled:l.a.bool.isRequired,type:l.a.string.isRequired,onClick:l.a.func.isRequired};var He=qe,ze=n("tw3r"),Me=function(){var e=Translator.trans("no_items.message",{},"sub_items");return i.a.createElement("div",{className:"c-no-items"},e)},Fe=n("AJkD"),Ze=n("iRWG"),Je={Accept:"application/vnd.ez.api.BulkOperationResponse+json","Content-Type":"application/vnd.ez.api.BulkOperation+json"},We={ContentId:"_contentId",ContentName:"_name",DateModified:"_dateModified",DatePublished:"_datePublished",LocationDepth:"_depth",LocationPath:"_path",LocationPriority:"_priority",SectionIdentifier:"_sectionIdentifier",SectionName:"_sectionName"};function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){$e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Qe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ye=function(e){return{uri:"".concat("/api/ezp/v2/user/users","/").concat(e),method:"DELETE"}},et=function(e,t){return{uri:"".concat("/api/ezp/v2/content/locations").concat(e.slice(0,-1)),method:"MOVE",headers:{Destination:t}}},tt=function(e,t){return{uri:"".concat("/api/ezp/v2/content/objects","/").concat(e,"/locations"),content:JSON.stringify({LocationCreate:{ParentLocation:{_href:t},sortField:"PATH",sortOrder:"ASC"}}),headers:{"Content-Type":"application/vnd.ez.api.LocationCreate+json"},method:"POST"}},nt=function(e,t){return{uri:"".concat("/api/ezp/v2/content/locations").concat(e.slice(0,-1)),content:JSON.stringify({LocationUpdate:{hidden:t,sortField:"PATH",sortOrder:"ASC"}}),headers:{"Content-Type":"application/vnd.ez.api.LocationUpdate+json"},method:"PATCH"}},rt=function(e,t,n){var r=n.BulkOperationResponse.operations,i=Object.entries(r).reduce((function(t,n){var r=Ge(n,2),i=r[0],a=r[1],o=e.find((function(e){return e.id===parseInt(i,10)}));return 200<=a.statusCode&&a.statusCode<=299?t.success.push(o):t.fail.push(o),t}),{success:[],fail:[]});t(i.success,i.fail)},it=function(e,t,n){var r=e.token,i=e.siteaccess,a=new Request("/api/ezp/v2/bulk",{method:"POST",headers:Xe(Xe({},Je),{},{"X-Siteaccess":i,"X-CSRF-Token":r}),body:JSON.stringify({bulkOperations:{operations:t}}),mode:"same-origin",credentials:"same-origin"});fetch(a).then(Ze.a).then(n).catch((function(){var e=Translator.trans("bulk_request.error.message",{},"sub_items");window.eZ.helpers.notification.showErrorNotification(e)}))};function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ot(){return(ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function st(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||ct(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(e){return function(e){if(Array.isArray(e))return ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ct(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vt(e);if(t){var i=vt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return yt(this,n)}}function yt(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?gt(e):t}function gt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _t="ascending",kt=_t,wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(l,e);var t,n,a,s=ht(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=s.call(this,e)).afterPriorityUpdated=t.afterPriorityUpdated.bind(gt(t)),t.switchView=t.switchView.bind(gt(t)),t.handleItemPriorityUpdate=t.handleItemPriorityUpdate.bind(gt(t)),t.toggleItemSelection=t.toggleItemSelection.bind(gt(t)),t.toggleAllPageItemsSelection=t.toggleAllPageItemsSelection.bind(gt(t)),t.onMoveBtnClick=t.onMoveBtnClick.bind(gt(t)),t.closeUdw=t.closeUdw.bind(gt(t)),t.onUdwConfirm=t.onUdwConfirm.bind(gt(t)),t.onDeleteBtnClick=t.onDeleteBtnClick.bind(gt(t)),t.onAddLocationsBtnClick=t.onAddLocationsBtnClick.bind(gt(t)),t.onHideBtnClick=t.onHideBtnClick.bind(gt(t)),t.onUnhideBtnClick=t.onUnhideBtnClick.bind(gt(t)),t.closeBulkDeletePopup=t.closeBulkDeletePopup.bind(gt(t)),t.closeBulkHidePopup=t.closeBulkHidePopup.bind(gt(t)),t.closeBulkUnhidePopup=t.closeBulkUnhidePopup.bind(gt(t)),t.onBulkDeletePopupConfirm=t.onBulkDeletePopupConfirm.bind(gt(t)),t.onBulkHidePopupConfirm=t.onBulkHidePopupConfirm.bind(gt(t)),t.onBulkUnhidePopupConfirm=t.onBulkUnhidePopupConfirm.bind(gt(t)),t.afterBulkDelete=t.afterBulkDelete.bind(gt(t)),t.afterBulkHide=t.afterBulkHide.bind(gt(t)),t.afterBulkUnhide=t.afterBulkUnhide.bind(gt(t)),t.changePage=t.changePage.bind(gt(t)),t.changeSorting=t.changeSorting.bind(gt(t)),t._refListViewWrapper=i.a.createRef(),t.bulkActionModalContainer=null,t.udwContainer=null;var n=t.getDefaultSortClause(e.sortClauses);return t.state={activeView:e.activeView,activePageItems:null,pages:[],selectedItems:new Map,totalCount:e.totalCount,offset:e.offset,isDuringBulkOperation:!1,isUdwOpened:!1,isBulkDeletePopupVisible:!1,isBulkHidePopupVisible:!1,isBulkUnhidePopupVisible:!1,activePageIndex:0,listViewHeight:null,actionFlow:null,sortClause:n.name,sortOrder:n.order},t}return t=l,(n=[{key:"componentDidMount",value:function(){this.udwContainer=document.getElementById("react-udw"),this.bulkActionModalContainer=document.createElement("div"),this.bulkActionModalContainer.classList.add("m-sub-items__bulk-action-modal-container"),document.body.appendChild(this.bulkActionModalContainer),this.state.activePageItems||this.loadPage(0)}},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.activePageIndex,n=e.activePageItems,r=e.totalCount,i=this.props.limit,a=Math.ceil(r/i);t>a-1&&0!==t?this.setState({activePageIndex:a-1}):(!n&&this.loadPage(t),eZ.helpers.tooltips.parse())}},{key:"componentWillUnmount",value:function(){document.body.removeChild(this.bulkActionModalContainer)}},{key:"getDefaultSortClause",value:function(e){var t=Object.keys(e);if(!t.length)return{name:null,order:null};var n=t[0];return{name:n,order:e[n]}}},{key:"updateListViewHeight",value:function(){var e=this;this.setState((function(){return{listViewHeight:e._refListViewWrapper.current.offsetHeight}}))}},{key:"loadPage",value:function(e){var t=this,n=this.props,r=n.limit,i=n.parentLocationId,a=n.loadLocation,o=n.restInfo,s=this.state,l=s.sortClause,c=s.sortOrder,u=this.state.pages.find((function(t){return t.number===e+1}));a(o,{locationId:i,limit:r,sortClause:l,sortOrder:c,cursor:u?u.cursor:null},(function(e){var n=e.data._repository.location.children,r=n.totalCount,i=n.pages,a=n.edges.map((function(e){return e.node}));t.setState((function(){return{activePageItems:a,totalCount:r,pages:i}}))}))}},{key:"updateTotalCountState",value:function(e){this.setState((function(){return{totalCount:e}}))}},{key:"discardActivePageItems",value:function(){this.updateListViewHeight(),this.setState((function(){return{activePageItems:null}}))}},{key:"changeSorting",value:function(e){var t=this;this.updateListViewHeight(),this.setState((function(n){return{sortClause:e,sortOrder:t.getSortOrder(n.sortClause,e,n.sortOrder),activePageItems:null}}))}},{key:"getSortOrder",value:function(e,t,n){return t===e?this.getOppositeSortOrder(n):kt}},{key:"getOppositeSortOrder",value:function(e){return e===_t?"descending":_t}},{key:"handleItemPriorityUpdate",value:function(e){this.props.updateLocationPriority(ft(ft({},e),this.props.restInfo),this.afterPriorityUpdated)}},{key:"afterPriorityUpdated",value:function(e){if("LocationPriority"===this.state.sortClause)return this.discardActivePageItems(),void this.refreshContentTree();this.updateItemLocation(e.Location)}},{key:"updateItemLocation",value:function(e){this.setState((function(t){var n=t.activePageItems,r=n.findIndex((function(t){return t.id===e.id}));if(-1===r)return null;var i=n[r],a=Object(Fe.a)(i),o=lt(n);return a.priority=e.priority,o[r]=a,{activePageItems:o}}))}},{key:"switchView",value:function(e){var t=this;this.setState((function(){return{activeView:e}}),(function(){eZ.helpers.tooltips.hideAll(),window.localStorage.setItem("ez-subitems-active-view-location-".concat(t.props.parentLocationId),e)}))}},{key:"toggleItemSelection",value:function(e,t){var n=this.state.selectedItems,r=new Map(n),i=e.id;t?r.set(i,e):r.delete(i),this.setState((function(){return{selectedItems:r}}))}},{key:"toggleAllPageItemsSelection",value:function(e){var t=this.state.activePageItems;if(e)this.selectItems(t);else{var n=t.map((function(e){return e.id})),r=new Set(n);this.deselectItems(r)}}},{key:"selectItems",value:function(e){var t=this.state.selectedItems,n=e.map((function(e){return[e.id,e]})),r=new Map([].concat(lt(t),lt(n)));this.setState((function(){return{selectedItems:r}}))}},{key:"deselectItems",value:function(e){var t=this.state.selectedItems,n=new Map(lt(t).filter((function(t){var n=st(t,1)[0];return!e.has(n)})));this.setState((function(){return{selectedItems:n}}))}},{key:"deselectAllItems",value:function(){this.setState((function(){return{selectedItems:new Map}}))}},{key:"toggleBulkOperationStatusState",value:function(e){this.setState((function(){return{isDuringBulkOperation:e}}))}},{key:"onMoveBtnClick",value:function(){this.setState((function(){return{actionFlow:"move"}})),this.toggleUdw(!0)}},{key:"onAddLocationsBtnClick",value:function(){this.setState((function(){return{actionFlow:"add"}})),this.toggleUdw(!0)}},{key:"bulkMove",value:function(e){this.toggleBulkOperationStatusState(!0),function(e,t,n,r){var i={};t.forEach((function(e){var t=e.id,r=e.pathString;i[t]=et(r,n)})),it(e,i,rt.bind(null,t,r))}(this.props.restInfo,lt(this.state.selectedItems.values()),e._href,this.afterBulkMove.bind(this,e))}},{key:"bulkAdd",value:function(e){this.toggleBulkOperationStatusState(!0),function(e,t,n,r){var i={};t.forEach((function(e){var t=e.id,r=e.content;i[t]=tt(r._info.id,n)})),it(e,i,rt.bind(null,t,r))}(this.props.restInfo,lt(this.state.selectedItems.values()),e._href,this.afterBulkAddLocation.bind(this,e))}},{key:"afterBulkMove",value:function(e,t,n){var r=this.state.totalCount;if(this.refreshContentTree(),this.updateTotalCountState(r-t.length),this.deselectAllItems(),this.discardActivePageItems(),this.toggleBulkOperationStatusState(!1),n.length){var i=Translator.trans("bulk_move.error.modal.table_title",{itemsCount:n.length},"sub_items"),a=Translator.trans("bulk_move.error.message",{notMovedCount:n.length,totalCount:t.length+n.length},"sub_items"),o={moreInformationLink:Translator.trans("bulk_action.error.more_info",{},"sub_items")};this.handleBulkOperationFailedNotification(n,i,a,o)}if(t.length){var s=Translator.trans("bulk_move.success.message",{},"sub_items"),l={locationLink:Translator.trans("bulk_action.success.link_to_location",{locationName:eZ.helpers.text.escapeHTML(e.ContentInfo.Content.Name),locationHref:this.props.generateLink(e.id,e.ContentInfo.Content._id)},"sub_items")};window.eZ.helpers.notification.showSuccessNotification(s,(function(){}),l)}}},{key:"afterBulkHide",value:function(e,t){if(this.deselectAllItems(),this.discardActivePageItems(),this.toggleBulkOperationStatusState(!1),t.length){var n=Translator.trans("bulk_hide.error.modal.table_title",{itemsCount:t.length},"sub_items"),r=Translator.trans("bulk_hide.error.message",{failedCount:t.length,totalCount:e.length+t.length},"sub_items"),i={moreInformationLink:Translator.trans("bulk_action.error.more_info",{},"sub_items")};this.handleBulkOperationFailedNotification(t,n,r,i)}if(e.length){var a=Translator.trans("bulk_hide.success.message",{},"sub_items");window.eZ.helpers.notification.showSuccessNotification(a)}}},{key:"afterBulkUnhide",value:function(e,t){if(this.deselectAllItems(),this.discardActivePageItems(),this.toggleBulkOperationStatusState(!1),t.length){var n=Translator.trans("bulk_unhide.error.modal.table_title",{itemsCount:t.length},"sub_items"),r=Translator.trans("bulk_unhide.error.message",{failedCount:t.length,totalCount:e.length+t.length},"sub_items"),i={moreInformationLink:Translator.trans("bulk_action.error.more_info",{},"sub_items")};this.handleBulkOperationFailedNotification(t,n,r,i)}if(e.length){var a=Translator.trans("bulk_unhide.success.message",{},"sub_items");window.eZ.helpers.notification.showSuccessNotification(a)}}},{key:"afterBulkAddLocation",value:function(e,t,n){if(this.deselectAllItems(),this.discardActivePageItems(),this.toggleBulkOperationStatusState(!1),n.length){var r=Translator.trans("bulk_add_location.error.modal.table_title",{itemsCount:n.length},"sub_items"),i=Translator.trans("bulk_add_location.error.message",{failedCount:n.length,totalCount:t.length+n.length},"sub_items"),a={moreInformationLink:Translator.trans("bulk_action.error.more_info",{},"sub_items")};this.handleBulkOperationFailedNotification(n,r,i,a)}if(t.length){var o=Translator.trans("bulk_add_location.success.message",{},"sub_items"),s={locationLink:Translator.trans("bulk_action.success.link_to_location",{locationName:eZ.helpers.text.escapeHTML(e.ContentInfo.Content.TranslatedName),locationHref:this.props.generateLink(e.id,e.ContentInfo.id)},"sub_items")};window.eZ.helpers.notification.showSuccessNotification(o,(function(){}),s)}}},{key:"toggleUdw",value:function(e){this.setState((function(){return{isUdwOpened:e}}))}},{key:"closeUdw",value:function(){this.toggleUdw(!1)}},{key:"onUdwConfirm",value:function(e){var t=st(e,1)[0];this.closeUdw(),"move"===this.state.actionFlow?this.bulkMove(t):this.bulkAdd(t)}},{key:"renderUdw",value:function(){var e=this.state,t=e.isUdwOpened,n=e.actionFlow;if(!t)return null;var r=window.eZ.modules.UniversalDiscovery,a=this.props,s=a.restInfo,l=a.parentLocationId,c=a.udwConfigBulkMoveItems,u=a.udwConfigBulkAddLocation,d=lt(this.state.selectedItems.values()).map((function(e){return e.id})),f=[l].concat(lt(d)),m="move"===n?c:u,p=ft({title:Translator.trans("udw.choose_location.title",{},"sub_items"),restInfo:s,onCancel:this.closeUdw,onConfirm:this.onUdwConfirm,canSelectContent:function(e,t){var n=e.item;t(!f.includes(n.id))}},m);return o.a.createPortal(i.a.createElement(r,p),this.udwContainer)}},{key:"onDeleteBtnClick",value:function(){this.toggleBulkDeletePopup(!0)}},{key:"onHideBtnClick",value:function(){this.toggleBulkHidePopup(!0)}},{key:"onUnhideBtnClick",value:function(){this.toggleBulkUnhidePopup(!0)}},{key:"bulkDelete",value:function(){this.toggleBulkOperationStatusState(!0),function(e,t,n){var r={};t.forEach((function(e){var t=e.id,n=e.pathString,i=e.content,a=i._info.contentType.identifier,o=window.eZ.adminUiConfig.userContentTypes.includes(a),s=i._info.id;r[t]=o?Ye(s):et(n,"/api/ezp/v2/content/trash")})),it(e,r,rt.bind(null,t,n))}(this.props.restInfo,lt(this.state.selectedItems.values()),this.afterBulkDelete)}},{key:"bulkHide",value:function(){this.toggleBulkOperationStatusState(!0),function(e,t,n){var r={};t.forEach((function(e){var t=e.id,n=e.pathString;r[t]=nt(n,!0)})),it(e,r,rt.bind(null,t,n))}(this.props.restInfo,lt(this.state.selectedItems.values()),this.afterBulkHide)}},{key:"bulkUnhide",value:function(){this.toggleBulkOperationStatusState(!0),function(e,t,n){var r={};t.forEach((function(e){var t=e.id,n=e.pathString;r[t]=nt(n,!1)})),it(e,r,rt.bind(null,t,n))}(this.props.restInfo,lt(this.state.selectedItems.values()),this.afterBulkUnhide)}},{key:"afterBulkDelete",value:function(e,t){var n=this.state.totalCount,r=function(e){var t=e.content;return window.eZ.adminUiConfig.userContentTypes.includes(t._info.contentType.identifier)};if(this.refreshContentTree(),this.updateTotalCountState(n-e.length),this.deselectAllItems(),this.discardActivePageItems(),this.toggleBulkOperationStatusState(!1),t.length){var i=t.some(r),a=t.some((function(e){return!r(e)})),o=null,s=null,l={moreInformationLink:Translator.trans("bulk_action.error.more_info",{},"sub_items")};i&&a?(o=Translator.trans("bulk_delete.error.modal.table_title.users_with_nonusers",{itemsCount:t.length},"sub_items"),s=Translator.trans("bulk_delete.error.message.users_with_nonusers",{notDeletedCount:t.length,totalCount:e.length+t.length},"sub_items")):i?(o=Translator.trans("bulk_delete.error.modal.table_title.users",{itemsCount:t.length},"sub_items"),s=Translator.trans("bulk_delete.error.message.users",{notDeletedCount:t.length,totalCount:e.length+t.length},"sub_items")):(o=Translator.trans("bulk_delete.error.modal.table_title.nonusers",{itemsCount:t.length},"sub_items"),s=Translator.trans("bulk_delete.error.message.nonusers",{notDeletedCount:t.length,totalCount:e.length+t.length},"sub_items")),this.handleBulkOperationFailedNotification(t,o,s,l)}else{var c=e.some(r),u=e.some((function(e){return!r(e)})),d=null;d=c&&u?Translator.trans("bulk_delete.success.message.users_with_nonusers",{},"sub_items"):c?Translator.trans("bulk_delete.success.message.users",{},"sub_items"):Translator.trans("bulk_delete.success.message.nonusers",{},"sub_items"),window.eZ.helpers.notification.showSuccessNotification(d)}}},{key:"toggleBulkDeletePopup",value:function(e){this.setState((function(){return{isBulkDeletePopupVisible:e}}))}},{key:"toggleBulkHidePopup",value:function(e){this.setState((function(){return{isBulkHidePopupVisible:e}}))}},{key:"toggleBulkUnhidePopup",value:function(e){this.setState((function(){return{isBulkUnhidePopupVisible:e}}))}},{key:"closeBulkDeletePopup",value:function(){this.toggleBulkDeletePopup(!1)}},{key:"closeBulkHidePopup",value:function(){this.toggleBulkHidePopup(!1)}},{key:"closeBulkUnhidePopup",value:function(){this.toggleBulkUnhidePopup(!1)}},{key:"onBulkDeletePopupConfirm",value:function(){this.closeBulkDeletePopup(),this.bulkDelete()}},{key:"onBulkHidePopupConfirm",value:function(){this.closeBulkHidePopup(),this.bulkHide()}},{key:"onBulkUnhidePopupConfirm",value:function(){this.closeBulkUnhidePopup(),this.bulkUnhide()}},{key:"handleBulkOperationFailedNotification",value:function(e,t,n,r){var i=this,a=e.map((function(e){return{contentTypeName:e._info.contentType.name,contentName:e._name}}));window.eZ.helpers.notification.showWarningNotification(n,(function(e){var n=e.querySelector(".ez-notification-btn--show-modal");n&&n.addEventListener("click",i.props.showBulkActionFailedModal.bind(null,t,a))}),r)}},{key:"refreshContentTree",value:function(){document.body.dispatchEvent(new CustomEvent("ez-content-tree-refresh"))}},{key:"renderDeleteConfirmationPopupFooter",value:function(e){var t=Translator.trans("bulk_action.popup.cancel",{},"sub_items"),n=e.isUserContentItemSelected,a=e.isNonUserContentItemSelected,o="";return o=!n&&a?Translator.trans("bulk_delete.popup.confirm.nonusers",{},"sub_items"):Translator.trans("bulk_delete.popup.confirm.users_and_users_with_nonusers",{},"sub_items"),i.a.createElement(r.Fragment,null,i.a.createElement("button",{onClick:this.closeBulkDeletePopup,type:"button",className:"btn btn-dark","data-dismiss":"modal"},t),i.a.createElement("button",{onClick:this.onBulkDeletePopupConfirm,type:"button",className:"btn btn-danger font-weight-bold btn--trigger"},o))}},{key:"renderHideConfirmationPopupFooter",value:function(){var e=Translator.trans("bulk_action.popup.cancel",{},"sub_items"),t=Translator.trans("bulk_hide.popup.confirm",{},"sub_items");return i.a.createElement(r.Fragment,null,i.a.createElement("button",{onClick:this.closeBulkHidePopup,type:"button",className:"btn btn-dark","data-dismiss":"modal"},e),i.a.createElement("button",{onClick:this.onBulkHidePopupConfirm,type:"button",className:"btn btn-danger font-weight-bold btn--trigger"},t))}},{key:"renderUnhideConfirmationPopupFooter",value:function(){var e=Translator.trans("bulk_action.popup.cancel",{},"sub_items"),t=Translator.trans("bulk_unhide.popup.confirm",{},"sub_items");return i.a.createElement(r.Fragment,null,i.a.createElement("button",{onClick:this.closeBulkUnhidePopup,type:"button",className:"btn btn-dark","data-dismiss":"modal"},e),i.a.createElement("button",{onClick:this.onBulkUnhidePopupConfirm,type:"button",className:"btn btn-danger font-weight-bold btn--trigger"},t))}},{key:"getSelectionInfo",value:function(){var e,t=!1,n=!1,r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=ct(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(this.state.selectedItems);try{for(r.s();!(e=r.n()).done;){var i=st(e.value,2),a=(i[0],i[1].content);if(t&&n)break;window.eZ.adminUiConfig.userContentTypes.includes(a._info.contentType.identifier)?t=!0:n=!0}}catch(e){r.e(e)}finally{r.f()}return{isUserContentItemSelected:t,isNonUserContentItemSelected:n}}},{key:"renderDeleteConfirmationPopup",value:function(){var e=this.state.isBulkDeletePopupVisible;if(!e)return null;var t=Translator.trans("bulk_delete.popup.message.users",{},"sub_items"),n=Translator.trans("bulk_delete.popup.message.nonusers",{},"sub_items"),r=Translator.trans("bulk_delete.popup.message.users_with_nonusers",{},"sub_items"),a=this.getSelectionInfo(),s=a.isUserContentItemSelected,l=a.isNonUserContentItemSelected,c="";return c=s&&l?r:s?t:n,o.a.createPortal(i.a.createElement(xe,{onClose:this.closeBulkDeletePopup,isVisible:e,isLoading:!1,size:"medium",footerChildren:this.renderDeleteConfirmationPopupFooter(a),noHeader:!0},i.a.createElement("div",{className:"m-sub-items__confirmation-modal-body"},c)),this.bulkActionModalContainer)}},{key:"renderHideConfirmationPopup",value:function(){var e=this.state.isBulkHidePopupVisible;if(!e)return null;var t=Translator.trans("bulk_hide.popup.message",{},"sub_items");return o.a.createPortal(i.a.createElement(xe,{onClose:this.closeBulkHidePopup,isVisible:e,isLoading:!1,size:"medium",footerChildren:this.renderHideConfirmationPopupFooter(),noHeader:!0},i.a.createElement("div",{className:"m-sub-items__confirmation-modal-body"},t)),this.bulkActionModalContainer)}},{key:"renderUnhideConfirmationPopup",value:function(){var e=this.state.isBulkUnhidePopupVisible;if(!e)return null;var t=Translator.trans("bulk_unhide.popup.message",{},"sub_items");return o.a.createPortal(i.a.createElement(xe,{onClose:this.closeBulkUnhidePopup,isVisible:e,isLoading:!1,size:"medium",footerChildren:this.renderUnhideConfirmationPopupFooter(),noHeader:!0},i.a.createElement("div",{className:"m-sub-items__confirmation-modal-body"},t)),this.bulkActionModalContainer)}},{key:"changePage",value:function(e){this.updateListViewHeight(),this.setState((function(){return{activePageIndex:e,activePageItems:null}}))}},{key:"getPageSelectedLocationsIds",value:function(){var e=this.state,t=e.selectedItems,n=e.activePageItems,r=lt(t.keys()),i=lt(n.map((function(e){return e.id})));return new Set(i.filter((function(e){return r.includes(e)})))}},{key:"renderExtraActions",value:function(e,t){var n=e.component;return i.a.createElement(n,ot({key:t,className:"m-sub-items__action"},e.attrs))}},{key:"renderPaginationInfo",value:function(){var e=this.state,t=e.totalCount,n=e.activePageItems,r=n?n.length:0,a=Translator.trans("viewing_message",{viewingCount:r,totalCount:t},"sub_items");return i.a.createElement("div",{className:"m-sub-items__pagination-info",dangerouslySetInnerHTML:{__html:a}})}},{key:"renderPagination",value:function(){var e=this.props.limit,t=this.state.totalCount,n=this.state,r=n.activePageIndex,a=n.activePageItems,o=n.isDuringBulkOperation,s=!a||o;return i.a.createElement(ze.a,{proximity:1,itemsPerPage:e,activePageIndex:r,totalCount:t,onPageChange:this.changePage,disabled:s})}},{key:"renderBulkMoveBtn",value:function(e){var t=Translator.trans("move_btn.label",{},"sub_items");return i.a.createElement(He,{disabled:e,onClick:this.onMoveBtnClick,label:t,type:"move"})}},{key:"renderBulkAddLocationBtn",value:function(e){var t=Translator.trans("add_locations_btn.label",{},"sub_items");return i.a.createElement(He,{disabled:e,onClick:this.onAddLocationsBtnClick,label:t,type:"create-location"})}},{key:"renderBulkHideBtn",value:function(e){var t=Translator.trans("hide_locations_btn.label",{},"sub_items");return i.a.createElement(He,{disabled:e,onClick:this.onHideBtnClick,label:t,type:"hide"})}},{key:"renderBulkUnhideBtn",value:function(e){var t=Translator.trans("unhide_locations_btn.label",{},"sub_items");return i.a.createElement(He,{disabled:e,onClick:this.onUnhideBtnClick,label:t,type:"reveal"})}},{key:"renderBulkDeleteBtn",value:function(e){var t=Translator.trans("trash_btn.label",{},"sub_items");return i.a.createElement(He,{disabled:e,onClick:this.onDeleteBtnClick,label:t,type:"trash"})}},{key:"renderSpinner",value:function(){if(this.state.activePageItems)return null;var e=this.state.listViewHeight,t={height:e&&e>90?e:90};return i.a.createElement("div",{style:t},i.a.createElement("div",{className:"m-sub-items__spinner-wrapper"},i.a.createElement(c.a,{name:"spinner",extraClasses:"m-sub-items__spinner ez-icon--medium ez-spin"})))}},{key:"renderNoItems",value:function(){return this.state.totalCount?null:i.a.createElement(Me,null)}},{key:"renderListView",value:function(){var e=this.state,t=e.activePageItems,n=e.sortClause,r=e.sortOrder;if(!t)return null;var a=this.getPageSelectedLocationsIds();return i.a.createElement(we,{activeView:this.state.activeView,handleItemPriorityUpdate:this.handleItemPriorityUpdate,items:t,languages:this.props.languages,handleEditItem:this.props.handleEditItem,generateLink:this.props.generateLink,onItemSelect:this.toggleItemSelection,toggleAllItemsSelect:this.toggleAllPageItemsSelection,selectedLocationsIds:a,onSortChange:this.changeSorting,sortClause:n,sortOrder:r})}},{key:"render",value:function(){var e=Translator.trans("items_list.title",{},"sub_items"),t=this.state,n=t.selectedItems,r=t.activeView,a=t.totalCount,o=t.isDuringBulkOperation,s=t.activePageItems,l=!(n.size&&"table"===r&&s),c=!0,u=!0,d="m-sub-items__list";if(o&&(d="".concat(d," ").concat(d,"--processing")),!l){var f=lt(n.values());c=!f.some((function(e){return!e.hidden})),u=!f.some((function(e){return!!e.hidden}))}return i.a.createElement("div",{className:"m-sub-items"},i.a.createElement("div",{className:"m-sub-items__header"},i.a.createElement("div",{className:"m-sub-items__title"},e," (",this.state.totalCount,")"),i.a.createElement("div",{className:"m-sub-items__actions"},this.props.extraActions.map(this.renderExtraActions),this.renderBulkMoveBtn(l),this.renderBulkAddLocationBtn(l),this.renderBulkHideBtn(c),this.renderBulkUnhideBtn(u),this.renderBulkDeleteBtn(l)),i.a.createElement(m,{onViewChange:this.switchView,activeView:r,isDisabled:!a})),i.a.createElement("div",{ref:this._refListViewWrapper,className:d},this.renderSpinner(),this.renderListView(),this.renderNoItems()),this.renderPaginationInfo(),this.renderPagination(),this.renderUdw(),this.renderDeleteConfirmationPopup(),this.renderHideConfirmationPopup(),this.renderUnhideConfirmationPopup())}}])&&pt(t.prototype,n),a&&pt(t,a),l}(r.Component);eZ.addConfig("modules.SubItems",wt),wt.propTypes={parentLocationId:l.a.number.isRequired,restInfo:l.a.shape({token:l.a.string.isRequired,siteaccess:l.a.string.isRequired}).isRequired,loadLocation:l.a.func,sortClauses:l.a.object,updateLocationPriority:l.a.func,activeView:l.a.string,extraActions:l.a.arrayOf(l.a.shape({component:l.a.func,attrs:l.a.object})),items:l.a.arrayOf(l.a.object),limit:l.a.number,offset:l.a.number,handleEditItem:l.a.func.isRequired,generateLink:l.a.func.isRequired,totalCount:l.a.number,languages:l.a.object,udwConfigBulkMoveItems:l.a.object.isRequired,udwConfigBulkAddLocation:l.a.object.isRequired,showBulkActionFailedModal:l.a.func.isRequired},wt.defaultProps={loadLocation:function(e,t,n){var r=e.token,i=e.siteaccess,a=t.locationId,o=void 0===a?2:a,s=t.limit,l=void 0===s?10:s,c=t.cursor,u=t.sortClause,d=t.sortOrder,f=c?', after: "'.concat(c,'"'):"",m=We[u],p=d===_t?"":"_desc",b=m?"sortBy: [".concat(m,", ").concat(p,"], "):"",h="\n    {\n        _repository {\n            location(locationId: ".concat(o,") {\n                pathString\n                children(").concat(b," first:").concat(l," ").concat(f,") {\n                    totalCount\n                    pages {\n                        number\n                        cursor\n                    }\n                    edges {\n                        node {\n                            id\n                            remoteId\n                            invisible\n                            hidden\n                            priority\n                            pathString\n    \n                            content {\n                                _thumbnail {\n                                    uri\n                                    alternativeText\n                                }\n                                _name\n                                _info {\n                                    id\n                                    name\n                                    remoteId\n                                    mainLanguageCode\n                                    owner {\n                                        name\n                                    }\n                                    currentVersion {\n                                        versionNumber\n                                        creator {\n                                            name\n                                        }\n                                        languageCodes\n                                    }\n                                    contentType {\n                                        name\n                                        identifier\n                                    }\n                                    section {\n                                        name\n                                    }\n                                    publishedDate {\n                                        timestamp\n                                    }\n                                    modificationDate {\n                                        timestamp\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }"),y=new Request("/graphql",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","X-Siteaccess":i,"X-CSRF-Token":r},body:JSON.stringify({query:h}),mode:"cors",credentials:"same-origin"});fetch(y).then(Ze.a).then(n).catch((function(){return window.eZ.helpers.notification.showErrorNotification("Cannot load location")}))},sortClauses:{},updateLocationPriority:function(e,t){var n=e.priority,r=e.pathString,i=e.token,a=e.siteaccess,o="".concat("/api/ezp/v2/content/locations").concat(r.slice(0,-1)),s=new Request(o,{method:"POST",headers:{Accept:"application/vnd.ez.api.Location+json","Content-Type":"application/vnd.ez.api.LocationUpdate+json","X-Siteaccess":a,"X-CSRF-Token":i,"X-HTTP-Method-Override":"PATCH"},credentials:"same-origin",mode:"cors",body:JSON.stringify({LocationUpdate:{priority:n,sortField:"PATH",sortOrder:"ASC"}})});fetch(s).then(Ze.a).then(t).catch((function(){return window.eZ.helpers.notification.showErrorNotification("An error occurred while updating location priority")}))},activeView:"table",extraActions:[],languages:window.eZ.adminUiConfig.languages,items:[],limit:parseInt(window.eZ.adminUiConfig.subItems.limit,10),offset:0,totalCount:0}},cDcd:function(e,t){e.exports=React},faye:function(e,t){e.exports=ReactDOM},iRWG:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=function(e){if(!e.ok)throw Error(e.statusText);return e},i=function(e){return r(e).json()},a=function(e){return r(e).status}},nLu2:function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return a}));var a=function(e){return"[object Object]"!==Object.prototype.toString.call(e)?"":Object.entries(e).reduce((function(e,t){var n=r(t,2),i=n[0],a=n[1];return"".concat(e," ").concat(a?i:"")}),"").trim()}},rf6O:function(e,t){e.exports=PropTypes},tw3r:function(e,t,n){"use strict";var r=n("cDcd"),i=n.n(r),a=n("rf6O"),o=n.n(a),s=function(e){var t=e.label,n=e.disabled,r=e.additionalClasses,a=e.onPageChange,o=e.pageIndex,s="c-pagination-button page-item ".concat(r);return s=n?"".concat(s," disabled"):s,i.a.createElement("li",{className:s},i.a.createElement("button",{className:"page-link",onClick:function(){!n&&Number.isInteger(o)&&a(o)},type:"button"},t))};s.propTypes={label:o.a.string.isRequired,disabled:o.a.bool,onPageChange:o.a.func,pageIndex:o.a.number.isRequired,additionalClasses:o.a.string},s.defaultProps={disabled:!1,additionalClasses:"",onPageChange:function(){}};var l=s,c=function(e){var t=e.totalCount,n=e.itemsPerPage,r=e.proximity,a=e.activePageIndex,o=e.onPageChange,s=e.disabled,c=Math.ceil(t/n);if(c<=1)return null;var u=Translator.trans("pagination.back",{},"sub_items"),d=Translator.trans("pagination.next",{},"sub_items"),f=a-1,m=a+1,p=0===a,b=a+1===c,h=function(e){for(var t=e.proximity,n=e.activePageIndex,r=e.pagesCount,i=e.separator,a=[],o=!1,s=1;s<=r;s++){1===s||s===r||s>=n+1-t&&s<=n+1+t?(a.push(s),o=!1):o||(a.push(i),o=!0)}return a}({proximity:r,activePageIndex:a,pagesCount:c,separator:"..."}).map((function(e,t){if("..."===e)return i.a.createElement(l,{key:"dots-".concat(t),label:"...",disabled:!0});var n=e===a+1?"active":"",r=""+e;return i.a.createElement(l,{key:e,pageIndex:e-1,label:r,additionalClasses:n,onPageChange:o,disabled:s})}));return i.a.createElement("ul",{className:"c-pagination pagination row justify-content-center"},i.a.createElement(l,{pageIndex:f,label:u,additionalClasses:"prev",disabled:p||s,onPageChange:o}),h,i.a.createElement(l,{pageIndex:m,label:d,additionalClasses:"next",disabled:b||s,onPageChange:o}))};c.propTypes={proximity:o.a.number.isRequired,itemsPerPage:o.a.number.isRequired,activePageIndex:o.a.number.isRequired,totalCount:o.a.number.isRequired,onPageChange:o.a.func.isRequired,disabled:o.a.bool.isRequired};t.a=c},uHg5:function(e,t,n){"use strict";var r=n("cDcd"),i=n.n(r),a=n("rf6O"),o=n.n(a),s=function(e){var t=e.customPath?e.customPath:"/bundles/ezplatformadminui/img/ez-icons.svg#".concat(e.name),n="ez-icon";return e.extraClasses&&(n="".concat(n," ").concat(e.extraClasses)),i.a.createElement("svg",{className:n},i.a.createElement("use",{xlinkHref:t}))};s.propTypes={extraClasses:o.a.string,name:o.a.string,customPath:o.a.string},s.defaultProps={customPath:null,name:null,extraClasses:null},t.a=s},xeH2:function(e,t){e.exports=jQuery}},[[34,"runtime"]]]);